[pytest]
addopts = -q -n auto --maxfail=1 --disable-warnings
testpaths = tests
pythonpath =
    tests/_compat  # AI-AGENT-REF: expose _compat shims including memory_optimizer
asyncio_mode = auto
env =
    PYTHONPATH = tests/_compat:${PYTHONPATH}
    YFINANCE_STUB=1  # AI-AGENT-REF: ensure yfinance stub for tests
markers =
    integration: may require network/keys; auto-skip if unavailable
    broker: hits broker API; auto-skip if missing keys
    network: uses live network
filterwarnings =
    ignore::DeprecationWarning
    ignore::FutureWarning
    # some third-party libs are chatty; keep CI green & readable
    ignore:.*is a deprecated alias.*:DeprecationWarning
    ignore:.deprecated alias.:DeprecationWarning
